!function(e,t){function n(e){return 'Eventist'}if("function"==typeof define&&define.amd)define([],t);else if("undefined"!=typeof exports){var o=t();"undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports[n(o)]=o}else{var o=t();e[n(o)]=o}}("undefined"==typeof window?this:window,function(){"use strict";function e(e,t){for(var n="",o=0;t>o;++o)n+=e;return n}function t(){}return t.verbose=0,t.prototype.subscribe=function(e){if(!this.id)throw console.error("Subscribe failed.",this),new Error("An eventist need an id to be able to subscribe");if(!(e instanceof t))throw new Error("An eventist could only subscribe to another eventist");var n=this._eventistVerbose|t.verbose;if(16&n){var o="☊ "+Util.getConstructorName(e)+" ← "+Util.getConstructorName(this);32&n?(console.groupCollapsed(o),console.log("event: ",evt),console.log("constructor: ",this.constructor),console.log("parent:",e),console.groupEnd()):console.log(o),128&n&&console.trace()}return e._eventistChildren=e._eventistChildren||{},e._eventistChildren[this.id]=this,this._eventistParent=e,this},t.prototype.unsubscribe=function(e){if(!this._eventistParent)throw new Error("But .. this eventist has no parent");if(e&&e!==this._eventistParent)throw new Error("Could not unsubscribe from a parent of someone else, lol");if(e=e||this._eventistParent,!e._eventistChildren||!e._eventistChildren[this.id])throw new Error("Could not find this eventist in the parent children list");var n=this._eventistVerbose|t.verbose;if(16&n){var o="☋  "+Util.getConstructorName(e)+" ↚ "+Util.getConstructorName(this);console.log(o),128&n&&console.trace()}return delete e._eventistChildren[this.id],this._eventistParent=null,this},t.prototype.on=function(e,t,n){var o=this._eventListeners=this._eventListeners||{};return e.split(/ |,|;|\|/).forEach(function(e){o[e]=o[e]||[],n=n||"append","append"===n?o[e].push(t):"prepend"===n?o[e].unshift(t):"set"===n&&(o[e]=[t])}),this._eventistUnbindMostRecentBinding=function(){this.off(e,t)}.bind(this),this},t.prototype.off=function(e,t){var n=this._eventListeners=this._eventListeners||{};return e.split(/ |,|;|\|/).forEach(function(o){var i=-1;n[o]&&n[o].length&&(i=n[o].indexOf(t)),i>=0&&(n[o].splice(i,1),console.log(e,t.toString()))}),this},t.prototype.dispatchEvent=function(n,o,i){var s=this._eventistVerbose|t.verbose;if(1&s){var r=Util.getConstructorName(this),h=i&&i.deep?" ":"★",c=i?"emit"===i.eventType?"↑":"↓":"-",l=i?i.deep:0,p=h+c+e(".",l)+" "+r+"#"+n;2&s?(console.groupCollapsed(p),console.log("event: ",n),console.log("constructor: ",this.constructor),console.log("args: ",o),console.log("origin: ",i),console.groupEnd()):console.log(p),8&s&&console.trace()}if(this._eventListeners){var v=this._eventListeners[n];if(v&&v.length)for(var a in v)v[a].call(this,i||{},o)}return this},t.prototype.emit=function(e,n,o){o=o||{eventType:"emit",target:this,hop:[]},o.hop.push(this);var i=this._eventistVerbose|t.verbose;return 1&i&&(o={eventType:o.eventType,target:o.target,deep:"undefined"!=typeof o.deep?o.deep+1:0}),this.dispatchEvent(e,n,o),this._eventistParent&&this._eventistParent.emit(e,n,o),this},t.prototype.trigger=t.prototype.emit,t.prototype.broadcast=function(e,n,o){o=o||{eventType:"broadcast",target:this,hop:[]},o.hop.push(this);var i=this._eventistVerbose|t.verbose;if(1&i&&(o={eventType:o.eventType,target:o.target,deep:"undefined"!=typeof o.deep?o.deep+1:0}),this.dispatchEvent(e,n,o),this._eventistChildren)for(var s in this._eventistChildren)this._eventistChildren[s].broadcast(e,n,o);return this},t});
